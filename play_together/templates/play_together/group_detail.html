{% extends "play_together/base.html" %}

{% load crispy_forms_filters %}

{% block title %}Group: {{ group.name }}{% endblock %}

{% block content %}
  <div class="row">
    <div class="col">
      <div class="row">
        <div class="col">
          <h2>{{ group.name }}</h2>
        </div>
      </div>
      <hr>
      <div class="row">
        <h4 class="col-auto">Games list</h4>
      </div>
      <div class="row">
        <div class="col">
          <table class="table">
            <thead>
            <tr>
              <th scope="col">Game</th>
              <th scope="col">Price</th>
              {% for player in player_list %}
                <th scope="col">{{ player.user.username }}</th>
              {% endfor %}
              <th scope="col">Crossplay</th>
            </tr>
            </thead>
            <tbody>
            {% for object in game_list %}
              <tr>
              <td>
                <div class="row">
                  <div class="col-auto">
                    <form action="{% url 'play_together:group-game-remove' group.pk %}" method="POST">
                      {% csrf_token %}
                      <input type="hidden" name="toggle_game" value="{{ object.game.id }}">
                      <button type="submit" class="close btn-delete btn-small" aria-label="Remove">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </form>
                  </div>
                  <div class="col-auto">
                    {{ object.game.name }}
                  </div>
                </div>
              </td>
              <td>{{ object.game.price }}</td>
              {% for console_list in object.player_list %}
                <td>
                  <div class="row align-items-center">
                    {% if console_list is False %}
                      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor"
                           class="bi bi-x text-danger" viewBox="0 0 16 16">
                        <path
                           d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                      </svg>
                    {% else %}
                      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor"
                           class="bi bi-check text-success" viewBox="0 0 16 16">
                        <path
                           d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                      </svg>
                      <span class="px-1">(</span>
                      {% for console in console_list %}
                        <img height="16" src="{{ console.icon.url }}" alt="{{ console.name }}">
                        {% if forloop.last %}{% else %}<span class="mx-1"></span> {% endif %}
                      {% endfor %}
                      <span class="px-1">)</span>
                    {% endif %}
                  </div>
                </td>
              {% endfor %}
              <td>{{ object.game.crossplay_support }}</td>
            {% endfor %}
            </tr>
            </tbody>
          </table>
          <form action="{% url 'play_together:group-game-add' group.pk %}" method="POST">
            {% csrf_token %}
            {{ add_game_form|crispy }}
            <input type="submit" value="Add" class="btn btn-success">
          </form>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
